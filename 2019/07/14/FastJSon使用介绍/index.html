<!--
	作者：Sariay
	时间：2018-09-25
	描述：There may be a bug, but don't worry, QiLing(器灵) says that it can work normally!
-->


	<!DOCTYPE html>
	<html>
		

<head><meta name="generator" content="Hexo 3.8.0">
	<title>FastJson使用说明</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="apple-mobile-web-app-title" content="Amaze UI">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta name="author" content="Hyhua">
    <meta name="keywords" content>
    <meta name="description" content>
   	<!-- css -->
	<link rel="stylesheet" href="/css/style.css">

	<!-- favicon -->
	<link href="/img/favicon.ico" rel="Shortcut Icon" type="image/ico">
	
	<!-- font-awesome -->
	<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
	<body>	
		<!--Preloader-->
<div id="preloader">
	<div id="status">
		<img alt="PRELOADER" src="/img/logo.png">
	</div>
</div>
<!--Preloader end-->

<!-- header -->

	<header id="header-bg-2">

	
		<div id="cd-logo"><a href="/"><img src="/img/logo.png" alt="Logo"></a></div>
	
	
	<!-- motto or description -->
		
 		<p class="motto"></p>
	
	
	<!-- current page name or title -->
	
		
		
			
			<p class="page-name">当前文章&nbsp;:&nbsp;《FastJson使用说明》</p>
			
		
	
	
	<!-- others: such as change-bg, time... -->
	<p class="page-name-other">
		7/14/2019 
		<style type="text/css">
	header:after {
		content: '';
		position: relative;
		top: 0;
		left: 0;
		height: 100%;
		width: 100%;
		background: #222222;
		opacity: .5;
		z-index: -1;
	}
	
	.change-header-bg{
		font-style: normal;
	}
	.change-header-bg i{
		text-align: center;
		cursor: pointer;
		pointer-events: bounding-box;
	}
	@media(max-width:512px) {
		.change-header-bg {
			display: none;
			visibility: hidden;
		}
	}
	
</style>

<script type="text/javascript">
	function changeHeaderBg(){
		var random_bg = Math.floor(Math.random() * 109 + 1);
		var bg = 'url(' + random_bg + '.jpg)';
		$("#header-bg-2").css("background-image", bg);
	}
</script>

<span class="change-header-bg">
	——&nbsp;<i class="fa fa-camera-retro" onclick="changeHeaderBg()"></i>	
</span>
	</p>		
</header>

<!-- nav -->
<div id="cd-nav">
	<a href="#0" title="menu" class="cd-nav-trigger"><span></span></a>

	<nav id="cd-main-nav">
		<ul>
			
      		<li class="fa fa-/">
           		<a href="/" title="主页">主页</a>	
      		</li>
    		
      		<li class="fa fa-/archives">
           		<a href="/archives" title="归档">归档</a>	
      		</li>
    		
      		<li class="fa fa-/categories">
           		<a href="/categories" title="分类">分类</a>	
      		</li>
    		
      		<li class="fa fa-/tags">
           		<a href="/tags" title="标签">标签</a>	
      		</li>
    		
      		<li class="fa fa-/about">
           		<a href="/about" title="关于">关于</a>	
      		</li>
    		
      		<li class="fa fa-/gallery">
           		<a href="/gallery" title="相册">相册</a>	
      		</li>
    		
    		
        	
		</ul>
	</nav>
</div>

		<!--main-->
		<main> 
		<div class="page-container">
		<!-- content srart -->
<div class="am-g am-g-fixed blog-fixed blog-content">
	<div class="am-u-md-8 am-u-sm-12">

		<article class="am-article blog-article-p">

			<div class="am-article-hd">
				


				<h1 class="am-article-title blog-text-center">
					
					
	
		<a href="/2019/07/14/FastJSon使用介绍/" itemprop="url">		
			FastJson使用说明		
		</a>
	

				</h1>

				<p class="am-article-meta blog-text-center">
					<span>
						<i class="fa fa-clock-o"></i> 
						<a href="/2019/07/14/FastJSon使用介绍/" itemprop="url">
	<time datetime="2019-07-14T04:04:47.000Z" itemprop="datePublished">
  		2019-07-14
  </time>
</a>    
&nbsp;
					</span>
					
					<span>						
						
							<i class="fa fa-tags"></i>
							
								<a href="#FastJson" title="FastJson" rel="1">FastJson</a>&nbsp;
													 											
						
					</span>
				</p>
			</div>

			<div class="am-article-bd">
				<div class="content" id="post-content">
					
						<h1 id="FastJson使用说明"><a href="#FastJson使用说明" class="headerlink" title="FastJson使用说明"></a>FastJson使用说明</h1><p>fastjson用于将Java Bean序列化为JSON字符串，也可以从JSON字符串反序列化到JavaBean。</p>
<h4 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h4><ul>
<li>通过maven引入相应的json包</li>
</ul>
<pre><code class="xml">    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
            &lt;artifactId&gt;fastjson&lt;/artifactId&gt;
            &lt;version&gt;1.2.49&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
</code></pre>
<ul>
<li><p>定义一个需要转换所实体类User，代码如下：</p>
</li>
<li><pre><code class="java">package com.ivan.json.entity;

import java.util.Date;

import com.alibaba.fastjson.annotation.JSONField;

public class User {

    private Long   id;

    private String name;

    @JSONField(format = &quot;yyyy-MM-dd HH:mm:ss&quot;)
    private Date   createTime;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Date getCreateTime() {
        return createTime;
    }

    public void setCreateTime(Date createTime) {
        this.createTime = createTime;
    }

}

</code></pre>
</li>
<li><p>写个简单的测试类用于测试fastjson的序列化与反序列化，代码如下：</p>
</li>
<li><pre><code class="java">package com.ivan.json;

import java.util.Date;

import com.alibaba.fastjson.JSON;
import com.ivan.json.entity.User;

public class SimpleTest {

    public static void main(String[] args) {
        serialize();
        deserialize();
    }

    public static void serialize() {
        User user = new User();
        user.setId(11L);
        user.setName(&quot;西安&quot;);
        user.setCreateTime(new Date());
        String jsonString = JSON.toJSONString(user);
        System.out.println(jsonString);
    }

    public static void deserialize() {
        String jsonString = &quot;{\&quot;createTime\&quot;:\&quot;2018-08-17 14:38:38\&quot;,\&quot;id\&quot;:11,\&quot;name\&quot;:\&quot;西安\&quot;}&quot;;
        User user = JSON.parseObject(jsonString, User.class);
        System.out.println(user.getName());
        System.out.println(user.getCreateTime());
    }
}

</code></pre>
</li>
<li><h4 id="SerializerFeature特性的使用"><a href="#SerializerFeature特性的使用" class="headerlink" title="SerializerFeature特性的使用"></a>SerializerFeature特性的使用</h4><p>  fastjson通过SerializerFeature对生成的json格式的数据进行一些定制，比如可以输入的格式更好看，使用单引号而非双引号等。例子程序如下</p>
<pre><code class="java">public class SerializerFeatureTest {

    public static void main(String[] args) {
        User user = new User();
        user.setId(11L);
        user.setCreateTime(new Date());
        String jsonString = JSON.toJSONString(user, SerializerFeature.PrettyFormat, 
                SerializerFeature.WriteNullStringAsEmpty, SerializerFeature.UseSingleQuotes);
        System.out.println(jsonString);

    }

}
</code></pre>
<p><code>`</code></p>
</li>
</ul>
<pre><code>
输出的结果如下

![img](https://upload-images.jianshu.io/upload_images/5796101-e4258d1405f31078.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/798/format/webp)

**SerializerFeature常用属性**

| 名称                           | 含义                                                         |
| :----------------------------- | :----------------------------------------------------------- |
| QuoteFieldNames                | 输出key时是否使用双引号,默认为true                           |
| UseSingleQuotes                | 使用单引号而不是双引号,默认为false                           |
| WriteMapNullValue              | 是否输出值为null的字段,默认为false                           |
| WriteEnumUsingToString         | Enum输出name()或者original,默认为false                       |
| UseISO8601DateFormat           | Date使用ISO8601格式输出，默认为false                         |
| WriteNullListAsEmpty           | List字段如果为null,输出为[],而非null                         |
| WriteNullStringAsEmpty         | 字符类型字段如果为null,输出为”“,而非null                     |
| WriteNullNumberAsZero          | 数值字段如果为null,输出为0,而非null                          |
| WriteNullBooleanAsFalse        | Boolean字段如果为null,输出为false,而非null                   |
| SkipTransientField             | 如果是true，类中的Get方法对应的Field是transient，序列化时将会被忽略。默认为true |
| SortField                      | 按字段名称排序后输出。默认为false                            |
| WriteTabAsSpecial              | 把\t做转义输出，默认为false不推荐设为true                    |
| PrettyFormat                   | 结果是否格式化,默认为false                                   |
| WriteClassName                 | 序列化时写入类型信息，默认为false。反序列化是需用到          |
| DisableCircularReferenceDetect | 消除对同一对象循环引用的问题，默认为false                    |
| WriteSlashAsSpecial            | 对斜杠’/’进行转义                                            |
| BrowserCompatible              | 将中文都会序列化为\uXXXX格式，字节数会多一些，但是能兼容IE 6，默认为false |
| WriteDateUseDateFormat         | 全局修改日期格式,默认为false。                               |
| DisableCheckSpecialChar        | 一个对象的字符串属性中如果有特殊字符如双引号，将会在转成json时带有反斜杠转移符。如果不需要转义，可以使用这个属性。默认为false |
| BeanToArray                    | 将对象转为array输出                                          |



#### JSONField与JSONType注解的使用

  fastjson提供了JSONField对序列化与反序列化进行定制，比如可以指定字段的名称，序列化的顺序。JSONField用于属性，方法方法参数上。JSONField的源码如下：

```java
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;
import com.alibaba.fastjson.parser.Feature;
import com.alibaba.fastjson.serializer.SerializerFeature;

@Retention(RetentionPolicy.RUNTIME)
@Target({ ElementType.METHOD, ElementType.FIELD, ElementType.PARAMETER })
public @interface JSONField {
// 配置序列化和反序列化的顺序
    int ordinal() default 0;
// 指定字段的名称
    String name() default &quot;&quot;;
// 指定字段的格式，对日期格式有用
    String format() default &quot;&quot;;
 // 是否序列化
    boolean serialize() default true;
// 是否反序列化
    boolean deserialize() default true;
//字段级别的SerializerFeature
    SerializerFeature[] serialzeFeatures() default {};
//
    Feature[] parseFeatures() default {};
   //给属性打上标签， 相当于给属性进行了分组
    String label() default &quot;&quot;;

    boolean jsonDirect() default false;

//制定属性的序列化类
    Class&lt;?&gt; serializeUsing() default Void.class;
 //制定属性的反序列化类
    Class&lt;?&gt; deserializeUsing() default Void.class;

    String[] alternateNames() default {};

    boolean unwrapped() default false;
}
</code></pre><p>其中serializeUsing与deserializeUsing可以用于对字段的序列化与反序列化进行定制化。比如我们在User实体上加上个sex属性，类型为boolean。下面分别定义了序列化类与反序列化类，了解例子的含义，此处是对序列化和反序列化的定制</p>
<h5 id="序列化类代码如下：-需要序列化的类实现ObjectSerializer"><a href="#序列化类代码如下：-需要序列化的类实现ObjectSerializer" class="headerlink" title="序列化类代码如下：(需要序列化的类实现ObjectSerializer)"></a>序列化类代码如下：(需要序列化的类实现<strong>ObjectSerializer</strong>)</h5><pre><code class="java">import java.io.IOException;
import java.lang.reflect.Type;

import com.alibaba.fastjson.serializer.JSONSerializer;
import com.alibaba.fastjson.serializer.ObjectSerializer;

public class SexSerializer implements ObjectSerializer {

    public void write(JSONSerializer serializer,
                      Object object,
                      Object fieldName,
                      Type fieldType,
                      int features)
            throws IOException {
        Boolean value = (Boolean) object;
        String text = &quot;女&quot;;
        if (value != null &amp;&amp; value == true) {
            text = &quot;男&quot;;
        }
        serializer.write(text);
    }

}
</code></pre>
<h5 id="反序列化类代码如下：-需要序列化的类实现ObjectDeserializer"><a href="#反序列化类代码如下：-需要序列化的类实现ObjectDeserializer" class="headerlink" title="反序列化类代码如下：(需要序列化的类实现ObjectDeserializer)"></a>反序列化类代码如下：(需要序列化的类实现<strong>ObjectDeserializer</strong>)</h5><pre><code class="java">package com.ivan.json.converter;

import java.lang.reflect.Type;


import com.alibaba.fastjson.parser.DefaultJSONParser;
import com.alibaba.fastjson.parser.JSONToken;
import com.alibaba.fastjson.parser.deserializer.ObjectDeserializer;

public class SexDeserialize implements ObjectDeserializer {

    public &lt;T&gt; T deserialze(DefaultJSONParser parser,
                                        Type type,
                                        Object fieldName) {



        String sex = parser.parseObject(String.class);
        if (&quot;男&quot;.equals(sex)) {
            return (T) Boolean.TRUE;
        } else {
            return (T) Boolean.FALSE;
        }
    }

    public int getFastMatchToken() {
        return JSONToken.UNDEFINED;
    }

}

</code></pre>
<p>fastjosn提供了JSONType用于类级别的定制化, JSONType的源码如下：</p>
<pre><code class="java">import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import com.alibaba.fastjson.PropertyNamingStrategy;
import com.alibaba.fastjson.parser.Feature;
import com.alibaba.fastjson.serializer.SerializeFilter;
import com.alibaba.fastjson.serializer.SerializerFeature;

@Retention(RetentionPolicy.RUNTIME)
//需要标注在类上
@Target({ ElementType.TYPE })
public @interface JSONType {

    boolean asm() default true;
//这里可以定义输出json的字段顺序
    String[] orders() default {};
//包含的字段
    String[] includes() default {};
//不包含的字段
    String[] ignores() default {};
//类级别的序列化特性定义
    SerializerFeature[] serialzeFeatures() default {};
    Feature[] parseFeatures() default {};
    //按字母顺序进行输出
    boolean alphabetic() default true;

    Class&lt;?&gt; mappingTo() default Void.class;

    Class&lt;?&gt; builder() default Void.class;

    String typeName() default &quot;&quot;;

    String typeKey() default &quot;&quot;;

    Class&lt;?&gt;[] seeAlso() default{};
    //序列化类
    Class&lt;?&gt; serializer() default Void.class;
    //反序列化类
    Class&lt;?&gt; deserializer() default Void.class;

    boolean serializeEnumAsJavaBean() default false;

    PropertyNamingStrategy naming() default PropertyNamingStrategy.CamelCase;

    Class&lt;? extends SerializeFilter&gt;[] serialzeFilters() default {};
}

</code></pre>
<h4 id="SerializeFilter"><a href="#SerializeFilter" class="headerlink" title="SerializeFilter"></a>SerializeFilter</h4><p>fastjson通过<strong>SerializeFilter</strong>编程扩展的方式定制序列化</p>
<p>fastjson支持以下SerializeFilter用于不同常景的定制序列化：</p>
<ul>
<li>PropertyFilter 根据PropertyName和PropertyValue来判断是否序列化,接口定义如下：</li>
</ul>
<pre><code class="java">package com.alibaba.fastjson.serializer;

/**
 * @author wenshao[szujobs@hotmail.com]
 */
public interface PropertyFilter extends SerializeFilter {

    /**
     * @param object the owner of the property
     * @param name the name of the property
     * @param value the value of the property
     * @return true if the property will be included, false if to be filtered out
    * 根据 属性的name与value判断是否进行序列化
     */
     boolean apply(Object object, String name, Object value);
}
</code></pre>
<ul>
<li><p>PropertyPreFilter根据PropertyName判断是否序列化</p>
</li>
<li><pre><code class="java">package com.alibaba.fastjson.serializer;

public interface PropertyPreFilter extends SerializeFilter {

//根据 object与name判断是否进行序列化
    boolean apply(JSONSerializer serializer, Object object, String name);
}
</code></pre>
</li>
</ul>
<ul>
<li><p>NameFilter 序列化时修改Key</p>
</li>
<li><pre><code class="java">package com.alibaba.fastjson.serializer;

public interface NameFilter extends SerializeFilter {
//根据 name与value的值，返回json字段key的值
    String process(Object object, String name, Object value);
}

</code></pre>
</li>
</ul>
<ul>
<li><p>ValueFilter 序列化时修改Value</p>
</li>
<li><pre><code class="java">package com.alibaba.fastjson.serializer;

public interface ValueFilter extends SerializeFilter {
  //根据name与value定制输出json的value
    Object process(Object object, String name, Object value);

}

</code></pre>
</li>
<li><p>BeforeFilter 在序列化对象的所有属性之前执行某些操作</p>
</li>
<li><pre><code class="java">package com.alibaba.fastjson.serializer;

public abstract class BeforeFilter implements SerializeFilter {

    private static final ThreadLocal&lt;JSONSerializer&gt; serializerLocal = new ThreadLocal&lt;JSONSerializer&gt;();
    private static final ThreadLocal&lt;Character&gt; seperatorLocal  = new ThreadLocal&lt;Character&gt;();
    private final static Character COMMA= Character.valueOf(&#39;,&#39;);

    final char writeBefore(JSONSerializer serializer, Object object, char seperator) {
        serializerLocal.set(serializer);
        seperatorLocal.set(seperator);
        writeBefore(object);
        serializerLocal.set(null);
        return seperatorLocal.get();
    }

    protected final void writeKeyValue(String key, Object value) {
        JSONSerializer serializer = serializerLocal.get();
        char seperator = seperatorLocal.get();
        serializer.writeKeyValue(seperator, key, value);
        if (seperator != &#39;,&#39;) {
            seperatorLocal.set(COMMA);
        }
    }
//需要实现的方法，在实际实现中可以调用writeKeyValue增加json的内容
    public abstract void writeBefore(Object object);
}

</code></pre>
</li>
</ul>
<ul>
<li><p>AfterFilter 在序列化对象的所有属性之后执行某些操作</p>
</li>
<li><pre><code class="java">/**
 * @since 1.1.35
 */
public abstract class AfterFilter implements SerializeFilter {

    private static final ThreadLocal&lt;JSONSerializer&gt; serializerLocal = new ThreadLocal&lt;JSONSerializer&gt;();
    private static final ThreadLocal&lt;Character&gt;      seperatorLocal  = new ThreadLocal&lt;Character&gt;();

    private final static Character                   COMMA           = Character.valueOf(&#39;,&#39;);

    final char writeAfter(JSONSerializer serializer, Object object, char seperator) {
        serializerLocal.set(serializer);
        seperatorLocal.set(seperator);
        writeAfter(object);
        serializerLocal.set(null);
        return seperatorLocal.get();
    }

    protected final void writeKeyValue(String key, Object value) {
        JSONSerializer serializer = serializerLocal.get();
        char seperator = seperatorLocal.get();
        serializer.writeKeyValue(seperator, key, value);
        if (seperator != &#39;,&#39;) {
            seperatorLocal.set(COMMA);
        }
    }
//子类需要实现的方法，实际使用的时候可以调用writeKeyValue增加内容
    public abstract void writeAfter(Object object);
}
</code></pre>
</li>
</ul>
<ul>
<li><p>LabelFilter根据 JsonField配置的label来判断是否进行输出</p>
</li>
<li><pre><code class="java">package com.alibaba.fastjson.serializer;

//根据 JsonField配置的label来判断是否进行输出
public interface LabelFilter extends SerializeFilter {
    boolean apply(String label);
}
</code></pre>
</li>
</ul>
<h4 id="泛型反序列化"><a href="#泛型反序列化" class="headerlink" title="泛型反序列化"></a>泛型反序列化</h4><p>  fastjson通过TypeReference来实现泛型的反序列化，</p>
<p>  以下是一个简单的例子程序。</p>
<p>  首先定义了BaseDTO用于所有DTO的父类，代码如下：</p>
<pre><code class="java">  package com.ivan.frame.dto.common;

  import java.io.Serializable;

  import com.alibaba.fastjson.JSONObject;

  public class BaseDTO implements Serializable{

      private static final long  serialVersionUID = 2230553030766621644L;

      @Override
      public String toString() {
          return JSONObject.toJSONString(this);
      }

  }
</code></pre>
<p>  RequestDTO用于抽像所有的请求DTO，里面有个泛型参数，代码如下：</p>
<pre><code class="java">  package com.ivan.frame.dto.common;


  public final class RequestDTO&lt;T extends BaseDTO&gt; extends BaseDTO {

      private static final long serialVersionUID = -2780042604928728379L;

      /**
       * 调用方的名称
       */
      private String            caller;

      /**
       * 请求参数
       */
      private T                 param;



      public String getCaller() {
          return caller;
      }

      public void setCaller(String caller) {
          this.caller = caller;
      }

      /**
       * 获取请求参数
       */
      public T getParam() {
          return param;
      }

      /**
       * 设置请求参数
       * 
       * @param param 请求参数
       */
      public void setParam(T param) {
          this.param = param;
      }

  }

</code></pre>
<p>  定义一个具体的业务对象， PersonDTO代码如下：</p>
<pre><code class="java">  package com.ivan.frame.dto;

  import com.ivan.frame.dto.common.BaseDTO;

  public class PersonDTO extends BaseDTO {

      private static final long serialVersionUID = 4637634512292751986L;

      private int id;
      private int age;
      private String name;

      public int getId() {
          return id;
      }
      public void setId(int id) {
          this.id = id;
      }
      public int getAge() {
          return age;
      }
      public void setAge(int age) {
          this.age = age;
      }
      public String getName() {
          return name;
      }
      public void setName(String name) {
          this.name = name;
      }

  }
</code></pre>
<p>  通过JSON.parseObject传入TypeReference对象进行泛型转换，代码如下：</p>
<pre><code class="java">  package com.ivan.json;

  import com.alibaba.fastjson.JSON;
  import com.alibaba.fastjson.TypeReference;
  import com.ivan.frame.dto.PersonDTO;
  import com.ivan.frame.dto.common.RequestDTO;

  public class GenericTest {

      public static void main(String[] args) {
          RequestDTO&lt;PersonDTO&gt; requestDTO = new RequestDTO&lt;PersonDTO&gt;();
          requestDTO.setCaller(&quot;callerId&quot;);
          PersonDTO personDTO = new PersonDTO();
          personDTO.setAge(11);
          personDTO.setName(&quot;张三&quot;);
          requestDTO.setParam(personDTO);

          String jsonString = JSON.toJSONString(requestDTO);
          System.out.println(jsonString);
          //这行是关键代码
          requestDTO = JSON.parseObject(jsonString, new TypeReference&lt;RequestDTO&lt;PersonDTO&gt;&gt;(){});


          System.out.println(requestDTO.getParam().getName());
      }
  }

</code></pre>
<h4 id="fastjson各种概念"><a href="#fastjson各种概念" class="headerlink" title="fastjson各种概念"></a>fastjson各种概念</h4><ul>
<li><p>JSON：本身是Abstract，提供了一系统的工具方法方便用户使用的API。</p>
<h6 id="序列化相关的概念"><a href="#序列化相关的概念" class="headerlink" title="序列化相关的概念:"></a>序列化相关的概念:</h6></li>
<li><p>SerializeConfig：内部是个map容器主要功能是配置并记录每种Java类型对应的序列化类。</p>
</li>
<li><p>SerializeWriter 继承自Java的Writer，其实就是个转为FastJSON而生的StringBuilder，完成高性能的字符串拼接。</p>
</li>
<li><p>SerializeFilter: 用于对对象的序列化实现各种定制化的需求。</p>
</li>
<li><p>SerializerFeature：对于对输出的json做各种格式化的需求。</p>
</li>
<li><p>JSONSerializer：相当于一个序列化组合器，集成了SerializeConfig， SerializeWriter ， SerializeFilter与SerializerFeature。<br> 序列化的入口代码如下，上面提到的各种概念都包含了</p>
</li>
</ul>
<pre><code class="java"> public static String toJSONString(Object object, // 
                                      SerializeConfig config, // 
                                      SerializeFilter[] filters, // 
                                      String dateFormat, //
                                      int defaultFeatures, // 
                                      SerializerFeature... features) {
        SerializeWriter out = new SerializeWriter(null, defaultFeatures, features);

        try {
            JSONSerializer serializer = new JSONSerializer(out, config);

            if (dateFormat != null &amp;&amp; dateFormat.length() != 0) {
                serializer.setDateFormat(dateFormat);
                serializer.config(SerializerFeature.WriteDateUseDateFormat, true);
            }

            if (filters != null) {
                for (SerializeFilter filter : filters) {
                    serializer.addFilter(filter);
                }
            }

            serializer.write(object);

            return out.toString();
        } finally {
            out.close();
        }
    }
</code></pre>
<h6 id="反序列化相关的概念"><a href="#反序列化相关的概念" class="headerlink" title="反序列化相关的概念"></a>反序列化相关的概念</h6><ul>
<li>ParserConfig：内部通过一个map保存各种ObjectDeserializer。</li>
<li>JSONLexer : 与SerializeWriter相对应，用于解析json字符串。</li>
<li>JSONToken：定义了一系统的特殊字符，这些称为token。</li>
<li>ParseProcess ：定制反序列化，类似于SerializeFilter。</li>
<li>Feature：用于定制各种反序列化的特性。</li>
<li>DefaultJSONParser：相当于反序列化组合器，集成了ParserConfig，Feature， JSONLexer 与ParseProcess。<br> 反序列化的入口代码如下，上面的概念基本都包含了</li>
</ul>
<pre><code class="java">@SuppressWarnings(&quot;unchecked&quot;)
    public static &lt;T&gt; T parseObject(String input, Type clazz, ParserConfig config, ParseProcess processor,
                                          int featureValues, Feature... features) {
        if (input == null) {
            return null;
        }

        if (features != null) {
            for (Feature feature : features) {
                featureValues |= feature.mask;
            }
        }

        DefaultJSONParser parser = new DefaultJSONParser(input, config, featureValues);

        if (processor != null) {
            if (processor instanceof ExtraTypeProvider) {
                parser.getExtraTypeProviders().add((ExtraTypeProvider) processor);
            }

            if (processor instanceof ExtraProcessor) {
                parser.getExtraProcessors().add((ExtraProcessor) processor);
            }

            if (processor instanceof FieldTypeResolver) {
                parser.setFieldTypeResolver((FieldTypeResolver) processor);
            }
        }

        T value = (T) parser.parseObject(clazz, null);

        parser.handleResovleTask(value);

        parser.close();

        return (T) value;
    }
</code></pre>
<p>本文引用自<a href="https://www.jianshu.com/p/eaeaa5dce258" target="_blank" rel="noopener">https://www.jianshu.com/p/eaeaa5dce258</a>；</p>
<p>有兴趣的朋友可以看下原文。</p>

					
				</div>
			</div>
		</article>

		<ul class="am-pagination">
    
    	<li class="am-pagination-prev">
   		<a class="pull-left" href="/2019/07/14/Java-反射初识/" title="反射是框架设计的灵魂">
      		&laquo; 上一篇
		</a>
		</li>
	
	
		<li class="am-pagination-next">
		<a class="pull-right" href="/2019/07/14/Kafka基本介绍-熟悉基础/" title="Kafka简单介绍">
			下一篇 &raquo;
		</a>
		</li>
	 
 </ul>
        

		<!-- 来必力City版安装代码 -->
<div id="lv-container" data-id="city" data-uid="MTAyMC80MTAzNC8xNzU1OQ==">
<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
</script>
<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
<!-- City版安装代码已完成 -->
		
		<!--
	时间：2018-09-24
	描述：The TOC module refers to 'https://github.com/codefine/hexo-theme-mellow', include toc.ejs、toc.js、toc.css. All rights reserved by codefine. 
-->

	
		<aside class="post-widget">
			<nav class="post-toc-wrap" id="post-toc">
				
					<strong>文章目录</strong>
				
				
				<!--toc(post.content)-->
				<ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#FastJson使用说明"><span class="post-toc-text">FastJson使用说明</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#简单使用"><span class="post-toc-text">简单使用</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#SerializerFeature特性的使用"><span class="post-toc-text">SerializerFeature特性的使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#序列化类代码如下：-需要序列化的类实现ObjectSerializer"><span class="post-toc-text">序列化类代码如下：(需要序列化的类实现ObjectSerializer)</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#反序列化类代码如下：-需要序列化的类实现ObjectDeserializer"><span class="post-toc-text">反序列化类代码如下：(需要序列化的类实现ObjectDeserializer)</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#SerializeFilter"><span class="post-toc-text">SerializeFilter</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#泛型反序列化"><span class="post-toc-text">泛型反序列化</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#fastjson各种概念"><span class="post-toc-text">fastjson各种概念</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-6"><a class="post-toc-link" href="#序列化相关的概念"><span class="post-toc-text">序列化相关的概念:</span></a></li><li class="post-toc-item post-toc-level-6"><a class="post-toc-link" href="#反序列化相关的概念"><span class="post-toc-text">反序列化相关的概念</span></a></li></ol></li></ol></li></ol>
			</nav>
			<div class="post-toc-bar"><div>
		</div></div></aside>
	

	</div>
</div>
		</div>
		</main>
		
		<!--footer-->
		<footer>
	<div class="blog-text-center">
		<div class="theme-annie-social">
				
				
					<a href="https://hu793141126.github.io/about/" title="Github" target="_blank"><i class="fa fa-github"></i>&nbsp;</a>
					
				
					<a href="https://hu793141126.github.io/about/" title="Weibo" target="_blank"><i class="fa fa-weibo"></i>&nbsp;</a>
				
				
					<a href="https://hu793141126.github.io/about/" title="Email" target="_blank"><i class="fa fa-envelope-o"></i>&nbsp;</a>
					
				
					<a href="https://hu793141126.github.io/about/" title="QQ" target="_blank"><i class="fa fa-qq"></i>&nbsp;</a>
					
				
					<a href="https://hu793141126.github.io/about/" title="Twitter" target="_blank"><i class="fa fa-twitter"></i>&nbsp;</a>
						
				
		</div>
	</div>

	<div class="blog-text-center">
		<div class="theme-annie-copyright">
			
				&copy; 2017 - 2019, content by Hyhua. All Rights Reserved.			       	
			
		</div>
	</div>

	<div class="blog-text-center">
		<div class="theme-annie-copyright">
			<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <span id="busuanzi_container_site_pv">Xiaohua博客页总访问量<span id="busuanzi_value_site_pv"></span>次</span>	
		</div>
	</div>
</footer>
		<!-- <script src="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script> -->

<script>
	window.jQuery || document.write('<script src="/js/jquery-2.1.1.min.js"><\/script>')
</script>

<style>
	.motto {
		color: #000000;
		font-size: 20px;
		margin: 100px 25% 0;
		width: 50%;
		line-height: 1.4;
		font-family:"KaiTi", "STXingkai", "Source Sans Pro", "Segoe UI", "Lucida Grande", Helvetica, Arial, "Microsoft YaHei", FreeSans, Arimo, "Droid Sans", "wenquanyi micro hei", "Hiragino Sans GB", "Hiragino Sans GB W3", FontAwesome, sans-serif;
		text-align: center;
	}
	@media(max-width: 890px) {
		.motto {	
			margin: 100px 10% 0;
			width: 80%;
		}
	}
	@media(max-width: 890px) {
		.motto {
			margin: 100px 5% 0;
			width: 90%;
		}
	}
</style>


	<script src="/js/motto.js"></script>
	<script type="text/javascript">
		$(".motto").html(getMingYanContent());
	</script>	





	<script type="text/javascript" src="/js/love.js"></script>



	<script type="text/javascript" src="/js/toc.js"></script>


<script type="text/javascript" src="/js/main.js"></script>

<script type="text/javascript">
	//generate a random img that pre_name 'from 0 to 110'
	var random_bg = Math.floor(Math.random() * 109 + 1);

	//var bg = 'url(/img/random/' + random_bg + '.jpg)';		
	var bg = 'url(' + random_bg + '.jpg)';

	$("#header-bg-2").css("background-image", bg);
</script>
		
		<!--back to top-->
        <style type="text/css">
	#totop {
		background: white;
		border-radius: 50%;
		position: fixed;
		right: 5.4%;
		bottom: 80px;
		cursor: pointer;
	}
	
	#totop a {
		color: #474747;
		background-color: transparent;
		padding: 10px;
		text-decoration: none;
	}
	
	@media(max-width:512px) {
		#totop {
			display: none;
			visibility: hidden;
		}
	}
</style>


	<div id="totop">
  		<a href="javascript:;" class="fa fa-arrow-up"></a>
	</div>

	</body>
	</html>

